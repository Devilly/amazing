<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<timeline>
  <entry>
    <step>1</step>
    <event>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>path = ds_list_create();

var endX = convertPixelToCellHorizontal(obj_character.x);
var endY = convertPixelToCellVertical(obj_character.y);
var startX = convertPixelToCellHorizontal(x);
var startY = convertPixelToCellVertical(y);

var xPixelDistance = obj_character.x - x;
var yPixelDistance = obj_character.y - y;
var pixelDistance = sqrt(sqr(xPixelDistance) + sqr(yPixelDistance));
var xPixelStep = xPixelDistance / pixelDistance;
var yPixelStep = yPixelDistance / pixelDistance;
if(pixelDistance &gt; 800) {
    return undefined;
}

var pixelViewPoint;
for(pixelViewPoint = 0; pixelViewPoint &lt;= pixelDistance; pixelViewPoint += global.cellSize) {
    if(!isValidPosition(convertPixelToCellHorizontal(x + pixelViewPoint * xPixelStep),
        convertPixelToCellVertical(y + pixelViewPoint * yPixelStep))) {
        
        return undefined;
    }
}

// Lower prio stands for shorter line value
// so first the low prios should be handled.
var positionsQueue = ds_priority_create();
addPathPosition(positionsQueue, startX, startY, endX, endY);

var positionsHistory = ds_map_create();
var visitedPositions = ds_list_create();

var previousPosition = undefined;
while(true) {
    var bestPosition = ds_priority_delete_min(positionsQueue);
    var xCoordinate = ds_map_find_value(bestPosition, "x");
    var yCoordinate = ds_map_find_value(bestPosition, "y");
    
    ds_list_add(visitedPositions, convertPositionToString(xCoordinate, yCoordinate));
    
    if(previousPosition != undefined) {
        ds_map_add(positionsHistory, bestPosition, previousPosition);
    }
    previousPosition = bestPosition;
        
    if((xCoordinate == endX) &amp;&amp; (yCoordinate == endY)) {
        break;
    }
    
    addPathPositionIfOkay(positionsQueue, visitedPositions, xCoordinate + 1, yCoordinate, endX, endY);
    addPathPositionIfOkay(positionsQueue, visitedPositions, xCoordinate - 1, yCoordinate, endX, endY);
    addPathPositionIfOkay(positionsQueue, visitedPositions, xCoordinate, yCoordinate + 1, endX, endY);
    addPathPositionIfOkay(positionsQueue, visitedPositions, xCoordinate, yCoordinate - 1, endX, endY);
}

while(previousPosition != undefined) {
    ds_list_insert(path, 0, previousPosition);
    previousPosition = ds_map_find_value(positionsHistory, previousPosition);
}

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </entry>
</timeline>
